---

title: 计算机网络
date: 2021-11-25 19:39:00
tags: 计网
cover_picture:

---

### 1、HTTP 的基本概念

http: 是互联网上应用最为广泛的一种网络协议，是一个客户端和服务器端`请求和应答的标准（TCP）`，用于从 WWW 服务器传输超文本到本地浏览器的`超文本传输协议`。


### 2、HTTP工作原理

HTTP协议定义Web客户端如何从Web服务器请求Web页面，以及服务器如何把Web页面传送给客户端。客户端向服务器发送一个请求报文，服务器以一个状态行作为响应。


### 3、HTTP请求/响应的步骤

- 1.客户端连接到Web服务器
- 2.发送HTTP请求
- 3.服务器接受请求并返回HTTP响应
- 4.释放TCP连接
- 5.客户端（浏览器）解析HTML内容

>记忆口诀：连接发送加响应，释放解析整过程。


### 4、HTTP 的 5 种方法

- GET---获取资源
- POST---传输资源
- PUT---更新资源
- DELETE---删除资源
- HEAD---获取报文首部


### 5、GET与POST的区别

**1.浏览器回退表现不同**： GET在浏览器回退时是无害的，而POST会再次提交请求
**2.浏览器对请求地址的处理不同**： GET请求地址会被浏览器主动缓存，而POST不会，除非手动设置
**3.浏览器对响应的处理不同**：GET请求参数会被完整的保留在浏览器历史记录里，而POST中的参数不会被保留
**4.参数大小不同：** GET请求在URL中传送的参数是有长度的限制，而POST没有限制
**5.安全性不同：** GET参数通过URL传递，会暴露，不安全；POST放在Request Body中，相对更安全
**6.针对数据操作的类型不同**：GET对数据进行查询，POST主要对数据进行增删改！简单说，GET是只读，POST是写。


### 6、HTTP报文的组成成分

请求报文：{ 请求行、请求头、空行、请求体 } 

请求行：{http方法、页面地址、http协议及版本} 

响应报文：{ 状态行、响应头、空行、响应体 }

状态行：{http协议及版本、状态码以及描述}


### 7、https 的基本概念

https:是以安全为目标的 HTTP 通道，即 HTTP 下 加入 SSL 层进行加密。 

https 协议的作用：建立一个信息安全通道，来确保数据的传输，确保网站的真实性。


### 8、http 和 https 的区别？

- http 是超文本传输协议，信息是明文传输，https 则是具有安全性的 ssl 加密传输协议。
- Https 协议需要 ca 证书，费用较高。 
- 使用不同的链接方式，端口也不同，一般，http 协议的端口为 80，https 的端口为 443。
- http 的连接很简单，是无状态的。

>记忆口诀：明文传输超文本，安全等级各不同。CA证书费用高，无状连接端难同。


### 9、https 协议的工作原理

客户端在使用 HTTPS 方式与 Web 服务器通信时有以下几个步骤：

1. 客户端使用 https url 访问服务器，则要求 web 服务器`建立 ssl 链接`。
2. web 服务器接收到客户端的请求之后，会`将网站的证书（证书中包含了公钥），传输给客户端`。
3. 客户端和 web 服务器端开始`协商 SSL 链接的安全等级`，也就是加密等级。
4. 客户端浏览器通过双方协商一致的安全等级，`建立会话密钥`，然后通过网站的公钥来加密会话密钥，并传送给网站。
5. web 服务器`通过自己的私钥解密出会话密钥`。
6. web 服务器`通过会话密钥加密与客户端之间的通信`。

>记忆口诀：一连二传三协商，四建五得六使用。


### 10、https 协议的优缺点

- HTTPS 协议要比 http 协议`安全`，可防止数据在传输过程中被窃取、改变，确保数据的完整性。
- https 握手阶段比较`费时`，会使页面加载时间延长 50%，增加 10%~20%的耗电。 
- https `缓存`不如 http 高效，会增加数据开销。 
- SSL 证书也需要钱，功能越强大的`证书费`用越高。 
- SSL 证书需要绑定 `IP`，不能再同一个 ip 上绑定多个域名，ipv4 资源支持不了这种消耗。


### 11、TCP/IP网络模型

TCP/IP模型是互联网的基础，它是一系列网络协议的总称。这些协议可以划分为四层，分别为链路层、网络层、传输层和应用层。

-   链路层：负责封装和解封装IP报文，发送和接受ARP/RARP报文等。
-   网络层：负责路由以及把分组报文发送给目标网络或主机。
-   传输层：负责对报文进行分组和重组，并以TCP或UDP协议格式封装报文。
-   应用层：负责向用户提供应用程序，比如HTTP、FTP、Telnet、DNS、SMTP等。

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2fa80b3b48a84bd18d8e708c56a1dc22~tplv-k3u1fbpfcp-watermark.image)


### 12、TCP三次握手

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/baf3d5df95a74f47a1d779ee50c3411f~tplv-k3u1fbpfcp-watermark.image?)

1.  第一次握手：客户端给服务端发一个 SYN 报文，并指明客户端的初始化序列号 **ISN**。此时客户端处于 **SYN_Send** 状态
1.  第二次握手：服务器收到客户端的 SYN 报文之后，会以自己的 SYN 报文作为应答，并且也是指定了自己的初始化序列号 ISN(s)，同时会把客户端的 ISN + 1 作为 ACK 的值，表示自己已经收到了客户端的 SYN，此时服务器处于 **SYN_REVD**的状态。
1.  第三次握手：客户端收到 SYN 报文之后，会发送一个 ACK 报文，当然，也是一样把服务器的 ISN + 1 作为 ACK 的值，表示已经收到了服务端的 SYN 报文，此时客户端处于 **establised** 状态。
1.  服务器收到 ACK 报文之后，也处于 **establised 状态**，此时，双方以建立起了链接

```
握手过程中传送的包里不包含数据，三次握手完毕后，客户端与服务器才正式开始传送数据。
```

### 13、TCP 四次挥手

1.  第一次挥手：客户端发送一个 FIN 报文，报文中会指定一个序列号。此时客户端处于**FIN_WAIT1**状态。
2.  第二次握手：服务端收到 FIN 之后，会发送 ACK 报文，且把客户端的序列号值 + 1 作为 ACK 报文的序列号值，表明已经收到客户端的报文了，此时服务端处于 **CLOSE_WAIT**状态。
3.  第三次挥手：如果服务端也想断开连接了，和客户端的第一次挥手一样，发给 FIN 报文，且指定一个序列号。此时服务端处于 **LAST_ACK** 的状态。
4.  第四次挥手：客户端收到 FIN 之后，一样发送一个 ACK 报文作为应答，且把服务端的序列号值 + 1 作为自己 ACK 报文的序列号值，此时客户端处于 **TIME_WAIT** 状态。需要过一阵子以确保服务端收到自己的 ACK 报文之后才会进入 CLOSED 状态
5.  服务端收到 ACK 报文之后，就处于关闭连接了，处于 CLOSED 状态。

> 这里特别需要主要的就是**TIME_WAIT**这个状态了，这个是面试的高频考点，就是要理解，为什么客户端发送 ACK 之后不直接关闭，而是要等一阵子才关闭。这其中的原因就是，要确保服务器是否已经收到了我们的 ACK 报文，如果没有收到的话，服务器会重新发 FIN 报文给客户端，客户端再次收到 ACK 报文之后，就知道之前的 ACK 报文丢失了，然后再次发送 ACK 报文

### 14、TCP和UDP的区别

1. TCP是面向`连接`的，而UDP是面向无连接的。

2. TCP仅支持`单播传输`，UDP 提供了单播，多播，广播的功能。

3. TCP的三次握手保证了连接的`可靠性`; UDP是无连接的、不可靠的一种数据传输协议，首先不可靠性体现在无连接上，通信都不需要建立连接，对接收到的数据也不发送确认信号，发送端不知道数据是否会正确接收。

4. UDP的`头部开销`比TCP的更小，数据`传输速率更高`，`实时性更好`。


### 15、HTTP 请求跨域问题

1. 跨域的原理

   **跨域**，是指浏览器不能执行其他网站的脚本。它是由浏览器的`同源策略`造成的。
   **同源策略**,是浏览器对 JavaScript 实施的安全限制，只要`协议、域名、端口`有任何一个不同，都被当作是不同的域。
   **跨域原理**，即是通过各种方式，`避开浏览器的安全限制`。

2. 解决方案

   - **JSONP**：
     ajax 请求受同源策略影响，不允许进行跨域请求，而 script 标签 src 属性中的链 接却可以访问跨域的 js 脚本，利用这个特性，服务端不再返回 JSON 格式的数据，而是 返回一段调用某个函数的 js 代码，在 src 中进行了调用，这样实现了跨域。

     步骤：

     1. 去创建一个script标签
     2. script的src属性设置接口地址
     3. 接口参数，必须要带一个自定义函数名，要不然后台无法返回数据
     4. 通过定义函数名去接受返回的数据

     ```js
     //动态创建 script
     var script = document.createElement('script');
     
     // 设置回调函数
     function getData(data) {
         console.log(data);
     }
     
     //设置 script 的 src 属性，并设置请求地址
     script.src = 'http://localhost:3000/?callback=getData';
     
     // 让 script 生效
     document.body.appendChild(script);
     ```

     **JSONP 的缺点**:
     JSON 只支持 get，因为 script 标签只能使用 get 请求； JSONP 需要后端配合返回指定格式的数据;

     不安全可能会遭受xss攻击

   - **document.domain**  基础域名相同 子域名不同

   - **window.name** 利用在一个浏览器窗口内，载入所有的域名都是共享一个 window.name

   - **CORS** CORS(Cross-origin resource sharing)跨域资源共享 服务器设置对CORS的支持原理：服务器设置Access-Control-Allow-Origin HTTP响应头之后，浏览器将会允许跨域请求

   - **proxy代理** 目前常用方式 最方便的跨域方案 
     nginx是一款极其强大的web服务器，其优点就是轻量级、启动快、高并发。

     跨域问题的产生是因为浏览器的同源政策造成的，但是服务器与服务器之间的数据交换是没有这个限制。

     反向代理就是采用这种方式，建立一个虚拟的代理服务器来接收 internet 上的链接请求，然后转发给内部网络上的服务器，并将从服务器上得到的结果，返回给 internet 上请求链接的客户端。现在的新项目中nginx几乎是首选，我们用node或者java开发的服务通常都需要经过nginx的反向代理。

   - **window.postMessage()**  利用h5新特性 window.postMessage()

   - **Websocket**


### 16、Cookie、sessionStorage、localStorage 的区别

**相同点**：

- 存储在客户端

**不同点**：

- cookie数据大小不能超过4k；sessionStorage和localStorage的存储比cookie大得多，可以达到5M+
- cookie设置的过期时间之前一直有效；localStorage永久存储，浏览器关闭后数据不丢失除非主动删除数据；sessionStorage数据在当前浏览器窗口关闭后自动删除
- cookie的数据会自动的传递到服务器；sessionStorage和localStorage数据保存在本地

### 17、HTTP状态码及常见状态码

#### HTTP状态码

- 1xx：指示信息类，表示请求已接受，继续处理
- 2xx：指示成功类，表示请求已成功接受
- 3xx：指示重定向，表示要完成请求必须进行更近一步的操作
- 4xx：指示客户端错误，请求有语法错误或请求无法实现
- 5xx：指示服务器错误，服务器未能实现合法的请求

#### 常见状态码

- 200 OK：客户端请求成功
- 301 Moved Permanently：所请求的页面已经永久重定向至新的URL
- 302 Found：所请求的页面已经临时重定向至新的URL
- 304 Not Modified 未修改。
- 403 Forbidden：对请求页面的访问被禁止
- 404 Not Found：请求资源不存在
- 500 Internal Server Error：服务器发生不可预期的错误原来缓冲的文档还可以继续使用
- 503 Server Unavailable：请求未完成，服务器临时过载或宕机，一段时间后可恢复正常

- 1xx（临时响应）表示临时响应并需要请求者继续执行操作的状态码
  - 100 - 继续 请求者应当继续提出请求。服务器返回此代码表示已收到请求的第一部分，正在等待其余部分
  - 101 - 切换协议 请求者已要求服务器切换协议，服务器已确认并准备切换

- 2xx（成功）表示成功处理了请求的状态码
  - `200` - 成功 服务器已经成功处理了请求。通常，这表示服务器提供了请求的网页
  - 201 - 已创建 请求成功并且服务器创建了新的资源
  - 202 - 已接受 服务器已接受请求，但尚未处理
  - 203 - 非授权信息 服务器已经成功处理了请求，但返回的信息可能来自另一来源
  - 204 - 无内容 服务器成功处理了请求，但没有返回任何内容
  - 205 - 重置内容 服务器成功处理了请求，但没有返回任何内容

- 3xx（重定向）表示要完成请求，需要进一步操作；通常，这些状态代码用来重定向
  - 300 - 多种选择 针对请求，服务器可执行多种操作。服务器可根据请求者（user agent）选择一项操作，或提供操作列表供请求者选择
  - `301` - 永久移动 请求的网页已永久移动到新位置。服务器返回此响应（对GET或HEAD请求的响应）时，会自动将请求者转到新位置
  - `302` - 临时移动 服务器目前从不同位置的网页响应请求，但请求者应继续使用原有位置来进行以后的请求
  - 303 - 查看其它位置 请求者应当对不同的位置使用单独的GET请求来检索响应时，服务器返回此代码
  - `304` - 未修改 自上次请求后，请求的网页未修改过。服务器返回此响应，不会返回网页的内容
  - 305 - 使用代理 请求者只能使用代理访问请求的网页。如果服务器返回此响应，还表示请求者应使用代理
  - `307` - 临时性重定向 服务器目前从不同位置的网页响应请求，但请求者应继续使用原有的位置来进行以后的请求

- 4xx（请求错误）这些状态码表示请求可能出错，妨碍了服务器的处理
  - `400` - 错误请求 服务器不理解请求的语法
  - `401` - 未授权 请求要求身份验证。对于需要登录的网页，服务器可能返回此响应
  - `403` - 禁止 服务器拒绝请求
  - `404` - 未找到 服务器找不到请求的网页
  - 405 - 方法禁用 禁用请求中指定的方法
  - 406 - 不接受 无法使用请求的内容特性响应请求的网页
  - `407` - 需要代理授权 此状态码与401（未授权）类似，但指定请求者应当授权使用代理
  - `408` - 请求超时 服务器等候请求时发生超时
  - 410 - 已删除 如果请求的资源已永久删除，服务器就会返回此响应
  - `413` - 请求实体过大 服务器无法处理请求，因为请求实体过大，超出了服务器的处理能力
  - `414` - 请求的URI过长 请求的URI（通常为网址）过长，服务器无法处理


- 5xx（服务器错误）这些状态码表示服务器在尝试处理请求时发生内部错误。这些错误可能是服务器本身的错误，而不是请求出错
  - `500` - 服务器内部错误 服务器遇到错误，无法完成请求
  - 501 - 尚未实施 服务器不具备完成请求的功能。例如，服务器无法识别请求方法时可能会返回此代码
  - `502` - 错误网关 服务器作为网关或代理，从上游服务器无法收到无效响应
  - `503` - 服务器不可用 服务器目前无法使用（由于超载或者停机维护）。通常，这只是暂时状态
  - `504` - 网关超时 服务器作为网关代理，但是没有及时从上游服务器收到请求
  - 505 - HTTP版本不受支持 服务器不支持请求中所用的HTTP协议版本

### 18、理解xss，csrf，ddos攻击原理以及避免方式

`XSS`(`Cross-Site Scripting`，**跨站脚本攻击**)是一种代码注入攻击。攻击者在目标网站上注入恶意代码，当被攻击者登陆网站时就会执行这些恶意代码，这些脚本可以读取 `cookie，session tokens`，或者其它敏感的网站信息，对用户进行钓鱼欺诈，甚至发起蠕虫攻击等。

`CSRF`（`Cross-site request forgery`）**跨站请求伪造**：攻击者诱导受害者进入第三方网站，在第三方网站中，向被攻击网站发送跨站请求。利用受害者在被攻击网站已经获取的注册凭证，绕过后台的用户验证，达到冒充用户对被攻击的网站执行某项操作的目的。

**XSS避免方式：**

1.  `url`参数使用`encodeURIComponent`方法转义
1.  尽量不要有`innerHtml`插入`HTML`内容
1.  使用特殊符号、标签转义符。

`CSRF`避免方式：

1.  添加验证码

1.  使用token

    -   服务端给用户生成一个token，加密后传递给用户
    -   用户在提交请求时，需要携带这个token
    -   服务端验证token是否正确

`DDoS`又叫分布式拒绝服务，全称 `Distributed Denial of Service`，其原理就是利用大量的请求造成资源过载，导致服务不可用。

**`DDos`避免方式：**

1.  限制单IP请求频率。
1.  防火墙等防护设置禁止`ICMP`包等
1.  检查特权端口的开放




### 19、HTTP1、HTTP2

HTTP/2 相比于 HTTP/1.1，可以说是大幅度提高了网页的性能，只需要升级到该协议就可以减少很多之前需要做的性能优化工作，虽如此但HTTP/2并非完美的，HTTP/3 就是为了解决 HTTP/2 所存在的一些问题而被推出来的。


#### **HTTP1.1 的缺陷**

1. 高延迟 — 队头阻塞(Head-Of-Line Blocking)

   `队头阻塞`是指当顺序发送的请求序列中的一个请求因为某种原因被阻塞时，在后面排队的所有请求也一并被阻塞，会导致客户端迟迟收不到数据。

   针对队头阻塞的解决办法:

   -   `将同一页面的资源分散到不同域名下，提升连接上限`。 
   -   `合并小文件减少资源数`，使用精灵图。
   -   `内联(Inlining)资源`是另外一种防止发送很多小图请求的技巧，将图片的原始数据嵌入在CSS文件里面的URL里，减少网络请求次数。
   -   `减少请求数量`，合并文件。

2. 无状态特性 — 阻碍交互

   `无状态是指协议对于连接状态没有记忆能力`。纯净的 HTTP 是没有 cookie 等机制的，每一个连接都是一个新的连接。

   `Header里携带的内容过大，在一定程度上增加了传输的成本`。且请求响应报文里有大量字段值都是重复的。

3. 明文传输 — 不安全性

   HTTP/1.1在传输数据时，所有`传输的内容都是明文`，客户端和服务器端都无法验证对方的身份，无法保证数据的安全性。

4. 不支持服务端推送

>记忆口诀：队头阻塞高延迟，无状态阻交互，明文传输不安全，服务推送不支持。

#### SPDY 协议与 HTTP/2 简介

#### 1、HTTP/2 简介

HTTP/2是现行HTTP协议（HTTP/1.x）的替代，但它不是重写。**HTTP/2基于SPDY，专注于性能，最大的一个目标是在用户和网站间只用一个连接（connection）** 。

#### 2、HTTP/2 新特性

##### （1）二进制传输

`HTTP/2传输数据量的大幅减少,主要有两个原因:以二进制方式传输和Header 压缩`。我们先来介绍二进制传输,HTTP/2 采用二进制格式传输数据，而非HTTP/1.x 里纯文本形式的报文 ，二进制协议解析起来更高效。`HTTP/2 将请求和响应数据分割为更小的帧，并且它们采用二进制编码`。

##### （2）头部 压缩

HTTP/2并没有使用传统的压缩算法，而是开发了专门的"HPACK”算法，在客户端和服务器两端建立“字典”，用索引号表示重复的字符串，还采用哈夫曼编码来压缩整数和字符串，可以达到50%~90%的高压缩率。

##### （3）多路复用

在 HTTP/2 中引入了多路复用的技术。多路复用很好的解决了浏览器限制同一个域名下的请求数量的问题，同时也更容易实现全速传输。

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f756ad3403bc4fe18e970c56677c796e~tplv-k3u1fbpfcp-watermark.image?)

##### （4）服务器推送

HTTP2还在一定程度上改变了传统的“请求-应答”工作模式，服务器不再是完全被动地响应请求，也可以新建“流”主动向客户端发送消息。减少等待的延迟，这被称为"`服务器推送`"（ Server Push，也叫 Cache push）

##### （5）提高安全性

出于兼容的考虑，HTTP/2延续了HTTP/1的“明文”特点，可以像以前一样使用明文传输数据，不强制使用加密通信，不过格式还是二进制，只是不需要解密。

但由于HTTPS已经是大势所趋，而且主流的浏览器Chrome、Firefox等都公开宣布只支持加密的HTTP/2，**所以“事实上”的HTTP/2是加密的**。也就是说，互联网上通常所能见到的HTTP/2都是使用"https”协议名，跑在TLS上面。HTTP/2协议定义了两个字符串标识符：“h2"表示加密的HTTP/2，“h2c”表示明文的HTTP/2。

##### （6）防止对头阻塞

http1.1如果第一个文件阻塞，第二个文件也就阻塞了。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b67bd1f793a3425d9e8a415cae9b7863~tplv-k3u1fbpfcp-watermark.image?)

http2.0的解决，把3个请求打包成一个小块发送过去，即使第一个阻塞了，后面2个也可以回来；相当于3个文件同时请求，就看谁先回来谁后回来，阻塞的可能就后回来，对带宽的利用是最高的；但没有解决TCP的对头阻塞，如果TCP发过去的一个分包发丢了，他会重新发一次；http2.0的解决了大文件的阻塞。

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/77d8ae8e0de44f3aa693f0626a346d4c~tplv-k3u1fbpfcp-watermark.image?)

一个分包请求3个文件，即使第一个阻塞了，第二个也能返回

#### 3.HTTP/2 的缺点

虽然 HTTP/2 解决了很多之前旧版本的问题，但它还是存在一个巨大的问题，**主要是底层支撑的 TCP 协议造成的**。HTTP/2的缺点主要有以下几点：

1.  TCP 以及 TCP+TLS 建立连接时延时
2.  TCP 的队头阻塞并没有彻底解决
3.  多路复用导致服务器压力上升也容易 Timeout

#### 4.http3特性：

http 协议是应用层协议，都是建立在传输层之上的。我们也都知道传输层上面不只有 TCP 协议，还有另外一个强大的协议 **UDP 协议**，2.0 和 1.0 都是基于 TCP 的，因此都会有 TCP 带来的硬伤以及局限性。而 Http3.0 则是建立在 UDP 的基础上。所以其与 Http2.0 之间有质的不同

- 连接迁移
- 无队头阻塞
- 自定义的拥塞控制
- 前向安全和前向纠错

#### 总结

-   HTTP/1.1有两个主要的缺点：安全不足和性能不高。
-   HTTP/2完全兼容HTTP/1，是“更安全的HTTP、更快的HTTPS"，二进制传输、头部压缩、多路复用、服务器推送等技术可以充分利用带宽，降低延迟，从而大幅度提高上网体验；

### 20、CDN：

简介：加快用户访问网络资源的速度和稳定性，减轻源服务器的访问压力

实现方法： 通过在网络各处放置**节点服务器**所构成的在现有的互联网基础之上的一层**智能虚拟网络**，CDN系统能够实时地根据网络流量和各节点的**连接和负载**状况以及到用户的**距离**和**响应时间**等综合信息将用户的请求重新**导向离用户最近的服务节点**上，加快访问速度

目的：使用户可`就近`取得所需内容，解决Internet网络拥挤的状况，提高用户访问网站的`响应速度`

**优势：**

1. CDN节点解决了跨运营商和跨地域访问的问题，访问延时大大降低；
2. 大部分请求在CDN边缘节点完成，CDN起到了分流作用，减轻了源站的负载。

### 21、jwt

jwt 可以生成 一个加密的token，做为用户登录的令牌，当用户登录成功之后，发放给客户端。请求需要登录的资源或者接口的时候，将token携带，后端验证token是否合法。

JWT的组成
jwt有三部分组成:A.B.C
A:Header，{“type”:“JWT”“alg”:“HS256”}固定 HS256加密方式

B:playload，存放信息，比如，用户id，过期时间等等，可以被解密，不能存放敏感信息

C:签证，A和B加上秘钥加密而成，只要秘钥不丢失，可以认为是安全的。
