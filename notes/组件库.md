##### 创建表格

```vue
<template>
	<ht-table-page ref="tableRef" :data="tableData" @on-action="onAction" />
</template>

<script lang="ts" setup>
import { reactive, ref, getCurrentInstance } from 'vue'
import { useRouter } from 'vue-router'
import { QtSelectGroup } from '@htfed/qt-ui'
import {
	onGetPartInListXhr,
	onDelPartInXhr,
} from '~/service/storage/part'
import { onGetWarehouseXhr } from '~/service/storage/space'
import { onGetStoreList } from '~/store/store'
import { onJump } from '~/static/utils/tools'
import { permissionInfo, dictsInfo } from '~/store/base'
import { onExport } from '~/static/utils/tools'

// 获取字典表业务类型
const partsInTypeList: any = dictsInfo['parts.in_warehouse.type'].arrayValue
const partsInTypeMap: any = dictsInfo['parts.in_warehouse.type'].objValue
const $router = useRouter()
const tableRef = ref(null)
const { $loading, $toast, $dialog }: any = getCurrentInstance()?.proxy
// 联动
const storeConfig = QtSelectGroup({
	onGetDataXhr: { xhr: onGetStoreList },
	formData: () => tableData.filterForm,
	field1: {
		label: '所属区域',
		prop: 'area_id',
	},
	field2: {
		label: '所属门店',
		prop: 'store_id',
	},
	field3: {
		display: 'none',
	},
})

// 列表数据
const tableData = reactive({
	request: {
		onGetListXhr: {
			xhr: onGetPartInListXhr,
            // 对参数进行处理
    		getParams: (params: any) => {
					const result = {
						...params,
						desensitize_switch: 1,
					}
					return result
				},
        	// 对结果进行处理
    		callback: (res: any) => {
				Object.assign(baseBlockData.model, res?.data)
				return {
					data: {
						list: res?.data?.details,
					},
				}
			},
		},
	},
	filterForm: {
		request: {
            // 筛选项初始化数据
			formInitial: {
				xhr: async () => {
					const { data: warehouseId } = await onGetWarehouseXhr()
					return {
						data: {
							createInfo: {
								warehouse_id: warehouseId.map(i => ({
									label: i.name,
									value: i.id,
								})),
							},
						},
					}
				},
			},
		},
		model: {},
		fields: [
			{
				type: 'input',
				label: '出库单号',
				prop: 'number',
				itemProps: {
					clearable: true,
				},
			},
			{
				type: 'select',
				label: '仓库名称',
				prop: 'warehouse_id',
				itemProps: {
					clearable: true,
				},
			},
			{
				type: 'select',
				label: '业务类型',
				prop: 'warehouse_type',
				itemProps: {
					clearable: true,
					options: partsInTypeList,
				},
			},
			...storeConfig.fields,
          	{
				type: 'datePicker',
				label: '申请时间',
				prop: 'created_time',
				itemProps: {
					type: 'dateRange',
					clearable: true,
				},
			},
		],
	},
	toolbar: [
		{
			type: 'add',
			show: () => permissionInfo.STORAGE_PARTIN_ADD,
		},
		{
			type: 'export',
			show: () => permissionInfo.STORAGE_PARTIN_EXPORT,
		},
	],
	table: {
		showOverflow: 'title',
		columns: [
			{
				type: 'seq',
			},
			{
				title: '入库单号',
				field: 'number',
				minWidth: 170,
				showConfig: {
					type: 'link',
					content: ({ row }: any) => {
						onJump(
							{
								path: '/storage/partInDetail',
								query: {
									id: row.id,
								},
							},
							$router
						)
					},
				},
			},
			{
				title: '来源单号',
				field: 'source_number',
				minWidth: 160,
				sortable: true,
			},
			{
				title: '业务类型',
				field: 'type',
				showConfig: {
					type: 'html',
					content: ({ row }: any) => partsInTypeMap[row.type],
				},
			},
			{
				title: '入库完成时间',
				field: 'storage_time',
				minWidth: 170,
				sortable: true,
			},
			{
				title: '交接人员',
				field: 'delivery_user_name',
			},
			{
				title: '操作',
				fixed: 'right',
				actions: [
					{
						type: 'edit',
						content: '修改',
						show: ({ row }: any) =>
							row.status === 1 && permissionInfo.STORAGE_PARTIN_ADD,
					},
					{
						type: 'delete',
						content: '删除',
						show: ({ row }: any) =>
							row.status === 1 && permissionInfo.STORAGE_PARTIN_DEL,
					},
				],
			},
		],
	},
})

// 表格操作项
const onAction = ({ action, row }: any) => {
	switch (action?.type) {
		case 'export':
			if (action.loading) return
			action.loading = true
			action.content = '导出中...'
			onExport({
				...tableData.filterForm?.model, // 筛选项参数
				type: 106, // 导出类型
			}).then(() => {
				action.loading = false
				action.content = '导出'
			})
			break
		case 'add':
			break
		case 'edit':
			break
		case 'delete':
			$dialog.show({
				content: '确认删除当前入库单？',
				onConfirm: async () => {
					const loading = $loading()
					const res = await onDelPartInXhr({
						id: row.id,
					})
					loading.close()
					if (res?.code === 0) {
						$toast.success('操作成功')
						tableRef.value?.onReLoadList()
					}
				},
			})
			break
		default:
			break
	}
}
</script>

```



